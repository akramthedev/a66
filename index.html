<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="#303030">
    <meta name="description" content="Web site created using create-react-app">
    <link rel="apple-touch-icon" href="/logo192.png">
    <link rel="manifest" href="/manifest.json">
    <title>Noobtech</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <script defer="defer" src="/static/js/main.839309db.js?v=112233"></script>
    <link href="./css1.css" rel="stylesheet">
    <link href="./css2.css" rel="stylesheet">
</head>

<body>
    <div id="root">
        <!-- <div class="containerTv">
            <div class="loading-overlay ">
                <div class="loader"></div>
            </div>
            <div class="Navbartvtvt  ">
                <div class="logo"><span>Dashboard <span>/ TV</span></span></div>
                <div class="NavContainer2"><a href="/dashboard/tv" data-discover="true"><button style="color: rgb(26, 117, 192); font-weight: 600;">TV</button></a><a href="/dashboard/tickets"
                        data-discover="true"><button style="color: rgb(48, 48, 48); font-weight: 400;">Tickets</button></a><a href="/dashboard/gestion-tickets" data-discover="true"><button
                            style="color: rgb(48, 48, 48); font-weight: 400;">Gestion Tickets</button></a><a href="/dashboard/compte" data-discover="true"><button
                            style="color: rgb(48, 48, 48); font-weight: 400;">Réglages</button></a></div>
                <div class="butContainer"><button class="fullScreen"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#1a75c0" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-expand-icon lucide-expand">
                            <path d="m15 15 6 6"></path>
                            <path d="m15 9 6-6"></path>
                            <path d="M21 16v5h-5"></path>
                            <path d="M21 8V3h-5"></path>
                            <path d="M3 16v5h5"></path>
                            <path d="m3 21 6-6"></path>
                            <path d="M3 8V3h5"></path>
                            <path d="M9 9 3 3"></path>
                        </svg></button><button class="enterFullScreen">Se déconnecter</button></div>
                <nav class="sidebar">
                    <ul>
                        <li><a href="#why">Fonctionnalités et Services</a><i class="fa-solid fa-chevron-right"></i></li>
                    </ul>
                    <div class="rowBtn1"><button class="register">Entrer en plein écran</button></div>
                </nav>
            </div>
            <div class="coneifso">
                <div class="containerHero">
                    <div class="containerImage" style="transition: box-shadow 0.6s; border-radius: 1.3rem;">
                        <div class="carousel">
                            <div class="slidesContainer" style="transition: box-shadow 0.6s; border-radius: 1.3rem; z-index: 9999999;">
                                <div class="slide active"><img alt="slide-0" src="https://res.cloudinary.com/dqprleeyt/image/upload/v1756335234/jw4w9m5jf0ihabawunqf.jpg"
                                        style="transition: box-shadow 0.6s; border-radius: 1.3rem; z-index: 9999999;"></div>
                                <div class="slide "><img alt="slide-1" src="https://res.cloudinary.com/dqprleeyt/image/upload/v1756335252/nb2xmjd6wjwfrtinw8p8.jpg"
                                        style="transition: box-shadow 0.6s; border-radius: 1.3rem; z-index: 9999999;"></div>
                            </div>
                            <div class="indicators"><button class="dot selected"></button><button class="dot "></button></div>
                        </div>
                    </div>
                    <div class="containerTimeWatherAndDescription">
                        <h5 style="color: rgb(25, 117, 245);">Bienvenue chers visiteurs</h5>
                        <p>---</p>
                    </div>
                </div>
                <div class="containerServices">
                    <div class="helloWorld0" style="color: rgb(25, 117, 245);">Mboup Business</div>
                    <div class="containerGridOfServices">
                        <div class="serviceItem">
                            <div class="serviceTitle">Pompier&nbsp;/&nbsp;Mourid</div>
                            <div class="serviceNumber " style="color: rgb(236, 71, 153);">n° 21</div>
                            <div class="serviceNext">Suivant :</div>
                            <div class="queueSquares">
                                <div class="square" role="status" aria-label="Prochain 1: 96" style="border-color: rgb(236, 71, 153); color: rgb(236, 71, 153);">96</div>
                            </div>
                        </div>
                        <div class="serviceItem">
                            <div class="serviceTitle">Policier&nbsp;/&nbsp;Réda</div>
                            <div class="serviceNumber " style="color: rgb(25, 117, 245);">n° 18</div>
                            <div class="serviceNext">Suivant :</div>
                            <div class="queueSquares">
                                <div class="square" role="status" aria-label="Prochain 1: 97" style="border-color: rgb(25, 117, 245); color: rgb(25, 117, 245);">97</div>
                            </div>
                        </div>
                        <div class="serviceItem">
                            <div class="serviceTitle">Ingenieurie&nbsp;/&nbsp;Med A Aziz</div>
                            <div class="serviceNumber " style="color: rgb(100, 116, 139);">n° 19</div>
                            <div class="serviceNext">Suivant :</div>
                            <div class="queueSquares"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
        <h1>
            Websockets System
        </h1>
        <button id="connectBtn">Connect WebSocket</button>
        <div id="messages"></div>
    </div>

    
    <script>
        const ENVIRONMENT = {
            BACKEND_URL: "universiapulse-001-site45.qtempurl.com"
        };

        let socket = null;

        const userId = 123;            
        const establishmentId = 456;    

        const messagesDiv = document.getElementById('messages');

        function logMessage(msg) {
            const p = document.createElement('p');
            p.textContent = msg;
            messagesDiv.appendChild(p);
            console.log(msg);
        }

        function connectWebSocket() {
        if (socket && socket.readyState === WebSocket.OPEN) {
            logMessage("WebSocket already connected");
            return;
        }

        socket = new WebSocket(`ws://${ENVIRONMENT.BACKEND_URL}`);

        socket.onopen = () => {
            logMessage("WebSocket connected");

            socket.send(JSON.stringify({
            action: 'register',
            payload: { userId, establishmentId }
            }));
        };

        socket.onmessage = (event) => {
            const message = JSON.parse(event.data);
                logMessage(`Message received: ${JSON.stringify(message)}`);

            if (message.action === 'hello_world') {
                logMessage(`Hello World from backend: ${JSON.stringify(message.payload)}`);
            } else if (['establishment_updated', 'bureau_updated', 'Ticket_Modified'].includes(message.action)) {
                logMessage('Data updated, refresh your UI here');
            }
        };

        socket.onerror = (err) => {
            logMessage(`WebSocket error: ${err}`);
        };

        socket.onclose = () => {
            logMessage("WebSocket disconnected");
            setTimeout(connectWebSocket, 3000);
        };
        }

        document.getElementById('connectBtn').addEventListener('click', connectWebSocket);
    </script>


</body>

</html>